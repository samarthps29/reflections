import{R,r as L}from"./react-d39729e7.js";import{r as Ft,R as _t}from"./react-dom-eb291ab4.js";import{P as I,a as z,S as _,T as O,N as $t,E as zt}from"./prosemirror-state-d99efc48.js";import{E as Kt}from"./prosemirror-view-d12f7755.js";import{k as Wt}from"./prosemirror-keymap-8634b7a8.js";import{F as q,S as Vt,D as Ut,a as qt,b as Gt}from"./prosemirror-model-714031c1.js";import{f as Jt,c as ft,l as Qt,a as G,R as Xt,b as Yt}from"./prosemirror-transform-4fc52813.js";import{c as Zt,d as te,e as ee,j as ne,a as re,b as se,f as oe,l as ie,g as ae,n as ce,s as ue,h as le,i as de,k as pe,m as fe,o as bt,w as he}from"./prosemirror-commands-175c63be.js";import{l as me,s as ge,w as ye}from"./prosemirror-schema-list-771d4f75.js";import{d as be}from"./prosemirror-dropcursor-da1713bb.js";import{g as ke}from"./prosemirror-gapcursor-5148966c.js";import{u as Me,r as Se,h as Te}from"./prosemirror-history-1f4dfada.js";function Y(t){const{state:e,transaction:n}=t;let{selection:r}=n,{doc:s}=n,{storedMarks:o}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),filterTransaction:e.filterTransaction,plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return o},get selection(){return r},get doc(){return s},get tr(){return r=n.selection,s=n.doc,o=n.storedMarks,n}}}class Z{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:n,state:r}=this,{view:s}=n,{tr:o}=r,i=this.buildProps(o);return Object.fromEntries(Object.entries(e).map(([a,u])=>[a,(...d)=>{const l=u(...d)(i);return!o.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(o),l}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,n=!0){const{rawCommands:r,editor:s,state:o}=this,{view:i}=s,a=[],u=!!e,c=e||o.tr,d=()=>(!u&&n&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(c),a.every(p=>p===!0)),l={...Object.fromEntries(Object.entries(r).map(([p,f])=>[p,(...g)=>{const y=this.buildProps(c,n),b=f(...g)(y);return a.push(b),l}])),run:d};return l}createCan(e){const{rawCommands:n,state:r}=this,s=!1,o=e||r.tr,i=this.buildProps(o,s);return{...Object.fromEntries(Object.entries(n).map(([u,c])=>[u,(...d)=>c(...d)({...i,dispatch:void 0})])),chain:()=>this.createChain(o,s)}}buildProps(e,n=!0){const{rawCommands:r,editor:s,state:o}=this,{view:i}=s;o.storedMarks&&e.setStoredMarks(o.storedMarks);const a={tr:e,editor:s,view:i,state:Y({state:o,transaction:e}),dispatch:n?()=>{}:void 0,chain:()=>this.createChain(e),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map(([u,c])=>[u,(...d)=>c(...d)(a)]))}};return a}}class ve{constructor(){this.callbacks={}}on(e,n){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(n),this}emit(e,...n){const r=this.callbacks[e];return r&&r.forEach(s=>s.apply(this,n)),this}off(e,n){const r=this.callbacks[e];return r&&(n?this.callbacks[e]=r.filter(s=>s!==n):delete this.callbacks[e]),this}removeAllListeners(){this.callbacks={}}}function m(t,e,n){return t.config[e]===void 0&&t.parent?m(t.parent,e,n):typeof t.config[e]=="function"?t.config[e].bind({...n,parent:t.parent?m(t.parent,e,n):null}):t.config[e]}function tt(t){const e=t.filter(s=>s.type==="extension"),n=t.filter(s=>s.type==="node"),r=t.filter(s=>s.type==="mark");return{baseExtensions:e,nodeExtensions:n,markExtensions:r}}function Ot(t){const e=[],{nodeExtensions:n,markExtensions:r}=tt(t),s=[...n,...r],o={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(i=>{const a={name:i.name,options:i.options,storage:i.storage},u=m(i,"addGlobalAttributes",a);if(!u)return;u().forEach(d=>{d.types.forEach(l=>{Object.entries(d.attributes).forEach(([p,f])=>{e.push({type:l,name:p,attribute:{...o,...f}})})})})}),s.forEach(i=>{const a={name:i.name,options:i.options,storage:i.storage},u=m(i,"addAttributes",a);if(!u)return;const c=u();Object.entries(c).forEach(([d,l])=>{const p={...o,...l};typeof(p==null?void 0:p.default)=="function"&&(p.default=p.default()),p!=null&&p.isRequired&&(p==null?void 0:p.default)===void 0&&delete p.default,e.push({type:i.name,name:d,attribute:p})})}),e}function w(t,e){if(typeof t=="string"){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}function T(...t){return t.filter(e=>!!e).reduce((e,n)=>{const r={...e};return Object.entries(n).forEach(([s,o])=>{if(!r[s]){r[s]=o;return}s==="class"?r[s]=[r[s],o].join(" "):s==="style"?r[s]=[r[s],o].join("; "):r[s]=o}),r},{})}function ut(t,e){return e.filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(t.attrs)||{}:{[n.name]:t.attrs[n.name]}).reduce((n,r)=>T(n,r),{})}function Ht(t){return typeof t=="function"}function M(t,e=void 0,...n){return Ht(t)?e?t.bind(e)(...n):t(...n):t}function we(t={}){return Object.keys(t).length===0&&t.constructor===Object}function xe(t){return typeof t!="string"?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):t==="true"?!0:t==="false"?!1:t}function kt(t,e){return t.style?t:{...t,getAttrs:n=>{const r=t.getAttrs?t.getAttrs(n):t.attrs;if(r===!1)return!1;const s=e.reduce((o,i)=>{const a=i.attribute.parseHTML?i.attribute.parseHTML(n):xe(n.getAttribute(i.name));return a==null?o:{...o,[i.name]:a}},{});return{...r,...s}}}}function Mt(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>e==="attrs"&&we(n)?!1:n!=null))}function Ae(t,e){var n;const r=Ot(t),{nodeExtensions:s,markExtensions:o}=tt(t),i=(n=s.find(c=>m(c,"topNode")))===null||n===void 0?void 0:n.name,a=Object.fromEntries(s.map(c=>{const d=r.filter(b=>b.type===c.name),l={name:c.name,options:c.options,storage:c.storage,editor:e},p=t.reduce((b,k)=>{const v=m(k,"extendNodeSchema",l);return{...b,...v?v(c):{}}},{}),f=Mt({...p,content:M(m(c,"content",l)),marks:M(m(c,"marks",l)),group:M(m(c,"group",l)),inline:M(m(c,"inline",l)),atom:M(m(c,"atom",l)),selectable:M(m(c,"selectable",l)),draggable:M(m(c,"draggable",l)),code:M(m(c,"code",l)),defining:M(m(c,"defining",l)),isolating:M(m(c,"isolating",l)),attrs:Object.fromEntries(d.map(b=>{var k;return[b.name,{default:(k=b==null?void 0:b.attribute)===null||k===void 0?void 0:k.default}]}))}),h=M(m(c,"parseHTML",l));h&&(f.parseDOM=h.map(b=>kt(b,d)));const g=m(c,"renderHTML",l);g&&(f.toDOM=b=>g({node:b,HTMLAttributes:ut(b,d)}));const y=m(c,"renderText",l);return y&&(f.toText=y),[c.name,f]})),u=Object.fromEntries(o.map(c=>{const d=r.filter(y=>y.type===c.name),l={name:c.name,options:c.options,storage:c.storage,editor:e},p=t.reduce((y,b)=>{const k=m(b,"extendMarkSchema",l);return{...y,...k?k(c):{}}},{}),f=Mt({...p,inclusive:M(m(c,"inclusive",l)),excludes:M(m(c,"excludes",l)),group:M(m(c,"group",l)),spanning:M(m(c,"spanning",l)),code:M(m(c,"code",l)),attrs:Object.fromEntries(d.map(y=>{var b;return[y.name,{default:(b=y==null?void 0:y.attribute)===null||b===void 0?void 0:b.default}]}))}),h=M(m(c,"parseHTML",l));h&&(f.parseDOM=h.map(y=>kt(y,d)));const g=m(c,"renderHTML",l);return g&&(f.toDOM=y=>g({mark:y,HTMLAttributes:ut(y,d)})),[c.name,f]}));return new Gt({topNode:i,nodes:a,marks:u})}function st(t,e){return e.nodes[t]||e.marks[t]||null}function St(t,e){return Array.isArray(e)?e.some(n=>(typeof n=="string"?n:n.name)===t.name):e}const Ee=(t,e=500)=>{let n="";const r=t.parentOffset;return t.parent.nodesBetween(Math.max(0,r-e),r,(s,o,i,a)=>{var u,c;const d=((c=(u=s.type.spec).toText)===null||c===void 0?void 0:c.call(u,{node:s,pos:o,parent:i,index:a}))||s.textContent||"%leaf%";n+=d.slice(0,Math.max(0,r-o))}),n};function ht(t){return Object.prototype.toString.call(t)==="[object RegExp]"}class V{constructor(e){this.find=e.find,this.handler=e.handler}}const Ce=(t,e)=>{if(ht(e))return e.exec(t);const n=e(t);if(!n)return null;const r=[n.text];return r.index=n.index,r.input=t,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r};function ot(t){var e;const{editor:n,from:r,to:s,text:o,rules:i,plugin:a}=t,{view:u}=n;if(u.composing)return!1;const c=u.state.doc.resolve(r);if(c.parent.type.spec.code||!((e=c.nodeBefore||c.nodeAfter)===null||e===void 0)&&e.marks.find(p=>p.type.spec.code))return!1;let d=!1;const l=Ee(c)+o;return i.forEach(p=>{if(d)return;const f=Ce(l,p.find);if(!f)return;const h=u.state.tr,g=Y({state:u.state,transaction:h}),y={from:r-(f[0].length-o.length),to:s},{commands:b,chain:k,can:v}=new Z({editor:n,state:g});p.handler({state:g,range:y,match:f,commands:b,chain:k,can:v})===null||!h.steps.length||(h.setMeta(a,{transform:h,from:r,to:s,text:o}),u.dispatch(h),d=!0)}),d}function Le(t){const{editor:e,rules:n}=t,r=new I({state:{init(){return null},apply(s,o){const i=s.getMeta(r);return i||(s.selectionSet||s.docChanged?null:o)}},props:{handleTextInput(s,o,i,a){return ot({editor:e,from:o,to:i,text:a,rules:n,plugin:r})},handleDOMEvents:{compositionend:s=>(setTimeout(()=>{const{$cursor:o}=s.state.selection;o&&ot({editor:e,from:o.pos,to:o.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(s,o){if(o.key!=="Enter")return!1;const{$cursor:i}=s.state.selection;return i?ot({editor:e,from:i.pos,to:i.pos,text:`
`,rules:n,plugin:r}):!1}},isInputRules:!0});return r}function $e(t){return typeof t=="number"}class Oe{constructor(e){this.find=e.find,this.handler=e.handler}}const He=(t,e)=>{if(ht(e))return[...t.matchAll(e)];const n=e(t);return n?n.map(r=>{const s=[r.text];return s.index=r.index,s.input=t,s.data=r.data,r.replaceWith&&(r.text.includes(r.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),s.push(r.replaceWith)),s}):[]};function Re(t){const{editor:e,state:n,from:r,to:s,rule:o}=t,{commands:i,chain:a,can:u}=new Z({editor:e,state:n}),c=[];return n.doc.nodesBetween(r,s,(l,p)=>{if(!l.isTextblock||l.type.spec.code)return;const f=Math.max(r,p),h=Math.min(s,p+l.content.size),g=l.textBetween(f-p,h-p,void 0,"￼");He(g,o.find).forEach(b=>{if(b.index===void 0)return;const k=f+b.index+1,v=k+b[0].length,C={from:n.tr.mapping.map(k),to:n.tr.mapping.map(v)},x=o.handler({state:n,range:C,match:b,commands:i,chain:a,can:u});c.push(x)})}),c.every(l=>l!==null)}function Pe(t){const{editor:e,rules:n}=t;let r=null,s=!1,o=!1;return n.map(a=>new I({view(u){const c=d=>{var l;r=!((l=u.dom.parentElement)===null||l===void 0)&&l.contains(d.target)?u.dom.parentElement:null};return window.addEventListener("dragstart",c),{destroy(){window.removeEventListener("dragstart",c)}}},props:{handleDOMEvents:{drop:u=>(o=r===u.dom.parentElement,!1),paste:(u,c)=>{var d;const l=(d=c.clipboardData)===null||d===void 0?void 0:d.getData("text/html");return s=!!(l!=null&&l.includes("data-pm-slice")),!1}}},appendTransaction:(u,c,d)=>{const l=u[0],p=l.getMeta("uiEvent")==="paste"&&!s,f=l.getMeta("uiEvent")==="drop"&&!o;if(!p&&!f)return;const h=c.doc.content.findDiffStart(d.doc.content),g=c.doc.content.findDiffEnd(d.doc.content);if(!$e(h)||!g||h===g.b)return;const y=d.tr,b=Y({state:d,transaction:y});if(!(!Re({editor:e,state:b,from:Math.max(h-1,0),to:g.b-1,rule:a})||!y.steps.length))return y}}))}function Ie(t){const e=t.filter((n,r)=>t.indexOf(n)!==r);return[...new Set(e)]}class F{constructor(e,n){this.splittableMarks=[],this.editor=n,this.extensions=F.resolve(e),this.schema=Ae(this.extensions,n),this.extensions.forEach(r=>{var s;this.editor.extensionStorage[r.name]=r.storage;const o={name:r.name,options:r.options,storage:r.storage,editor:this.editor,type:st(r.name,this.schema)};r.type==="mark"&&(!((s=M(m(r,"keepOnSplit",o)))!==null&&s!==void 0)||s)&&this.splittableMarks.push(r.name);const i=m(r,"onBeforeCreate",o);i&&this.editor.on("beforeCreate",i);const a=m(r,"onCreate",o);a&&this.editor.on("create",a);const u=m(r,"onUpdate",o);u&&this.editor.on("update",u);const c=m(r,"onSelectionUpdate",o);c&&this.editor.on("selectionUpdate",c);const d=m(r,"onTransaction",o);d&&this.editor.on("transaction",d);const l=m(r,"onFocus",o);l&&this.editor.on("focus",l);const p=m(r,"onBlur",o);p&&this.editor.on("blur",p);const f=m(r,"onDestroy",o);f&&this.editor.on("destroy",f)})}static resolve(e){const n=F.sort(F.flatten(e)),r=Ie(n.map(s=>s.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(s=>`'${s}'`).join(", ")}]. This can lead to issues.`),n}static flatten(e){return e.map(n=>{const r={name:n.name,options:n.options,storage:n.storage},s=m(n,"addExtensions",r);return s?[n,...this.flatten(s())]:n}).flat(10)}static sort(e){return e.sort((r,s)=>{const o=m(r,"priority")||100,i=m(s,"priority")||100;return o>i?-1:o<i?1:0})}get commands(){return this.extensions.reduce((e,n)=>{const r={name:n.name,options:n.options,storage:n.storage,editor:this.editor,type:st(n.name,this.schema)},s=m(n,"addCommands",r);return s?{...e,...s()}:e},{})}get plugins(){const{editor:e}=this,n=F.sort([...this.extensions].reverse()),r=[],s=[],o=n.map(i=>{const a={name:i.name,options:i.options,storage:i.storage,editor:e,type:st(i.name,this.schema)},u=[],c=m(i,"addKeyboardShortcuts",a);let d={};if(i.type==="mark"&&i.config.exitable&&(d.ArrowRight=()=>H.handleExit({editor:e,mark:i})),c){const g=Object.fromEntries(Object.entries(c()).map(([y,b])=>[y,()=>b({editor:e})]));d={...d,...g}}const l=Wt(d);u.push(l);const p=m(i,"addInputRules",a);St(i,e.options.enableInputRules)&&p&&r.push(...p());const f=m(i,"addPasteRules",a);St(i,e.options.enablePasteRules)&&f&&s.push(...f());const h=m(i,"addProseMirrorPlugins",a);if(h){const g=h();u.push(...g)}return u}).flat();return[Le({editor:e,rules:r}),...Pe({editor:e,rules:s}),...o]}get attributes(){return Ot(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:n}=tt(this.extensions);return Object.fromEntries(n.filter(r=>!!m(r,"addNodeView")).map(r=>{const s=this.attributes.filter(u=>u.type===r.name),o={name:r.name,options:r.options,storage:r.storage,editor:e,type:w(r.name,this.schema)},i=m(r,"addNodeView",o);if(!i)return[];const a=(u,c,d,l)=>{const p=ut(u,s);return i()({editor:e,node:u,getPos:d,decorations:l,HTMLAttributes:p,extension:r})};return[r.name,a]}))}}function Be(t){return Object.prototype.toString.call(t).slice(8,-1)}function it(t){return Be(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function et(t,e){const n={...t};return it(t)&&it(e)&&Object.keys(e).forEach(r=>{it(e[r])?r in t?n[r]=et(t[r],e[r]):Object.assign(n,{[r]:e[r]}):Object.assign(n,{[r]:e[r]})}),n}class E{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=M(m(this,"addOptions",{name:this.name}))),this.storage=M(m(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new E(e)}configure(e={}){const n=this.extend();return n.options=et(this.options,e),n.storage=M(m(n,"addStorage",{name:n.name,options:n.options})),n}extend(e={}){const n=new E(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=M(m(n,"addOptions",{name:n.name})),n.storage=M(m(n,"addStorage",{name:n.name,options:n.options})),n}}function Rt(t,e,n){const{from:r,to:s}=e,{blockSeparator:o=`

`,textSerializers:i={}}=n||{};let a="",u=!0;return t.nodesBetween(r,s,(c,d,l,p)=>{var f;const h=i==null?void 0:i[c.type.name];h?(c.isBlock&&!u&&(a+=o,u=!0),l&&(a+=h({node:c,pos:d,parent:l,index:p,range:e}))):c.isText?(a+=(f=c==null?void 0:c.text)===null||f===void 0?void 0:f.slice(Math.max(r,d)-d,s-d),u=!1):c.isBlock&&!u&&(a+=o,u=!0)}),a}function Pt(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,e])=>e.spec.toText).map(([e,n])=>[e,n.spec.toText]))}const Ne=E.create({name:"clipboardTextSerializer",addProseMirrorPlugins(){return[new I({key:new z("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:r,selection:s}=e,{ranges:o}=s,i=Math.min(...o.map(d=>d.$from.pos)),a=Math.max(...o.map(d=>d.$to.pos)),u=Pt(n);return Rt(r,{from:i,to:a},{textSerializers:u})}}})]}}),je=()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var n;t.isDestroyed||(e.dom.blur(),(n=window==null?void 0:window.getSelection())===null||n===void 0||n.removeAllRanges())}),!0),De=(t=!1)=>({commands:e})=>e.setContent("",t),Fe=()=>({state:t,tr:e,dispatch:n})=>{const{selection:r}=e,{ranges:s}=r;return n&&s.forEach(({$from:o,$to:i})=>{t.doc.nodesBetween(o.pos,i.pos,(a,u)=>{if(a.type.isText)return;const{doc:c,mapping:d}=e,l=c.resolve(d.map(u)),p=c.resolve(d.map(u+a.nodeSize)),f=l.blockRange(p);if(!f)return;const h=Qt(f);if(a.type.isTextblock){const{defaultType:g}=l.parent.contentMatchAt(l.index());e.setNodeMarkup(f.start,g)}(h||h===0)&&e.lift(f,h)})}),!0},_e=t=>e=>t(e),ze=()=>({state:t,dispatch:e})=>Zt(t,e),Ke=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,r=n.$anchor.node();if(r.content.size>0)return!1;const s=t.selection.$anchor;for(let o=s.depth;o>0;o-=1)if(s.node(o).type===r.type){if(e){const a=s.before(o),u=s.after(o);t.delete(a,u).scrollIntoView()}return!0}return!1},We=t=>({tr:e,state:n,dispatch:r})=>{const s=w(t,n.schema),o=e.selection.$anchor;for(let i=o.depth;i>0;i-=1)if(o.node(i).type===s){if(r){const u=o.before(i),c=o.after(i);e.delete(u,c).scrollIntoView()}return!0}return!1},Ve=t=>({tr:e,dispatch:n})=>{const{from:r,to:s}=t;return n&&e.delete(r,s),!0},Ue=()=>({state:t,dispatch:e})=>te(t,e),qe=()=>({commands:t})=>t.keyboardShortcut("Enter"),Ge=()=>({state:t,dispatch:e})=>ee(t,e);function Q(t,e,n={strict:!0}){const r=Object.keys(e);return r.length?r.every(s=>n.strict?e[s]===t[s]:ht(e[s])?e[s].test(t[s]):e[s]===t[s]):!0}function lt(t,e,n={}){return t.find(r=>r.type===e&&Q(r.attrs,n))}function Je(t,e,n={}){return!!lt(t,e,n)}function mt(t,e,n={}){if(!t||!e)return;let r=t.parent.childAfter(t.parentOffset);if(t.parentOffset===r.offset&&r.offset!==0&&(r=t.parent.childBefore(t.parentOffset)),!r.node)return;const s=lt([...r.node.marks],e,n);if(!s)return;let o=r.index,i=t.start()+r.offset,a=o+1,u=i+r.node.nodeSize;for(lt([...r.node.marks],e,n);o>0&&s.isInSet(t.parent.child(o-1).marks);)o-=1,i-=t.parent.child(o).nodeSize;for(;a<t.parent.childCount&&Je([...t.parent.child(a).marks],e,n);)u+=t.parent.child(a).nodeSize,a+=1;return{from:i,to:u}}function B(t,e){if(typeof t=="string"){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}const Qe=(t,e={})=>({tr:n,state:r,dispatch:s})=>{const o=B(t,r.schema),{doc:i,selection:a}=n,{$from:u,from:c,to:d}=a;if(s){const l=mt(u,o,e);if(l&&l.from<=c&&l.to>=d){const p=O.create(i,l.from,l.to);n.setSelection(p)}}return!0},Xe=t=>e=>{const n=typeof t=="function"?t(e):t;for(let r=0;r<n.length;r+=1)if(n[r](e))return!0;return!1};function It(t){return t instanceof O}function N(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function Bt(t,e=null){if(!e)return null;const n=_.atStart(t),r=_.atEnd(t);if(e==="start"||e===!0)return n;if(e==="end")return r;const s=n.from,o=r.to;return e==="all"?O.create(t,N(0,s,o),N(t.content.size,s,o)):O.create(t,N(e,s,o),N(e,s,o))}function gt(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const Ye=(t=null,e={})=>({editor:n,view:r,tr:s,dispatch:o})=>{e={scrollIntoView:!0,...e};const i=()=>{gt()&&r.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(r.focus(),e!=null&&e.scrollIntoView&&n.commands.scrollIntoView())})};if(r.hasFocus()&&t===null||t===!1)return!0;if(o&&t===null&&!It(n.state.selection))return i(),!0;const a=Bt(s.doc,t)||n.state.selection,u=n.state.selection.eq(a);return o&&(u||s.setSelection(a),u&&s.storedMarks&&s.setStoredMarks(s.storedMarks),i()),!0},Ze=(t,e)=>n=>t.every((r,s)=>e(r,{...n,index:s})),tn=(t,e)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},t,e);function Tt(t){const e=`<body>${t}</body>`;return new window.DOMParser().parseFromString(e,"text/html").body}function X(t,e,n){if(n={slice:!0,parseOptions:{},...n},typeof t=="object"&&t!==null)try{return Array.isArray(t)&&t.length>0?q.fromArray(t.map(r=>e.nodeFromJSON(r))):e.nodeFromJSON(t)}catch(r){return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",r),X("",e,n)}if(typeof t=="string"){const r=Ut.fromSchema(e);return n.slice?r.parseSlice(Tt(t),n.parseOptions).content:r.parse(Tt(t),n.parseOptions)}return X("",e,n)}function en(t,e,n){const r=t.steps.length-1;if(r<e)return;const s=t.steps[r];if(!(s instanceof Xt||s instanceof Yt))return;const o=t.mapping.maps[r];let i=0;o.forEach((a,u,c,d)=>{i===0&&(i=d)}),t.setSelection(_.near(t.doc.resolve(i),n))}const nn=t=>t.toString().startsWith("<"),rn=(t,e,n)=>({tr:r,dispatch:s,editor:o})=>{if(s){n={parseOptions:{},updateSelection:!0,...n};const i=X(e,o.schema,{parseOptions:{preserveWhitespace:"full",...n.parseOptions}});if(i.toString()==="<>")return!0;let{from:a,to:u}=typeof t=="number"?{from:t,to:t}:t,c=!0,d=!0;if((nn(i)?i:[i]).forEach(p=>{p.check(),c=c?p.isText&&p.marks.length===0:!1,d=d?p.isBlock:!1}),a===u&&d){const{parent:p}=r.doc.resolve(a);p.isTextblock&&!p.type.spec.code&&!p.childCount&&(a-=1,u+=1)}c?Array.isArray(e)?r.insertText(e.map(p=>p.text||"").join(""),a,u):typeof e=="object"&&e&&e.text?r.insertText(e.text,a,u):r.insertText(e,a,u):r.replaceWith(a,u,i),n.updateSelection&&en(r,r.steps.length-1,-1)}return!0},sn=()=>({state:t,dispatch:e})=>ne(t,e),on=()=>({state:t,dispatch:e})=>re(t,e),an=()=>({state:t,dispatch:e})=>se(t,e),cn=()=>({state:t,dispatch:e})=>oe(t,e);function Nt(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function un(t){const e=t.split(/-(?!$)/);let n=e[e.length-1];n==="Space"&&(n=" ");let r,s,o,i;for(let a=0;a<e.length-1;a+=1){const u=e[a];if(/^(cmd|meta|m)$/i.test(u))i=!0;else if(/^a(lt)?$/i.test(u))r=!0;else if(/^(c|ctrl|control)$/i.test(u))s=!0;else if(/^s(hift)?$/i.test(u))o=!0;else if(/^mod$/i.test(u))gt()||Nt()?i=!0:s=!0;else throw new Error(`Unrecognized modifier name: ${u}`)}return r&&(n=`Alt-${n}`),s&&(n=`Ctrl-${n}`),i&&(n=`Meta-${n}`),o&&(n=`Shift-${n}`),n}const ln=t=>({editor:e,view:n,tr:r,dispatch:s})=>{const o=un(t).split(/-(?!$)/),i=o.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),a=new KeyboardEvent("keydown",{key:i==="Space"?" ":i,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),u=e.captureTransaction(()=>{n.someProp("handleKeyDown",c=>c(n,a))});return u==null||u.steps.forEach(c=>{const d=c.map(r.mapping);d&&s&&r.maybeStep(d)}),!0};function K(t,e,n={}){const{from:r,to:s,empty:o}=t.selection,i=e?w(e,t.schema):null,a=[];t.doc.nodesBetween(r,s,(l,p)=>{if(l.isText)return;const f=Math.max(r,p),h=Math.min(s,p+l.nodeSize);a.push({node:l,from:f,to:h})});const u=s-r,c=a.filter(l=>i?i.name===l.node.type.name:!0).filter(l=>Q(l.node.attrs,n,{strict:!1}));return o?!!c.length:c.reduce((l,p)=>l+p.to-p.from,0)>=u}const dn=(t,e={})=>({state:n,dispatch:r})=>{const s=w(t,n.schema);return K(n,s,e)?ie(n,r):!1},pn=()=>({state:t,dispatch:e})=>ae(t,e),fn=t=>({state:e,dispatch:n})=>{const r=w(t,e.schema);return me(r)(e,n)},hn=()=>({state:t,dispatch:e})=>ce(t,e);function nt(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function vt(t,e){const n=typeof e=="string"?[e]:e;return Object.keys(t).reduce((r,s)=>(n.includes(s)||(r[s]=t[s]),r),{})}const mn=(t,e)=>({tr:n,state:r,dispatch:s})=>{let o=null,i=null;const a=nt(typeof t=="string"?t:t.name,r.schema);return a?(a==="node"&&(o=w(t,r.schema)),a==="mark"&&(i=B(t,r.schema)),s&&n.selection.ranges.forEach(u=>{r.doc.nodesBetween(u.$from.pos,u.$to.pos,(c,d)=>{o&&o===c.type&&n.setNodeMarkup(d,void 0,vt(c.attrs,e)),i&&c.marks.length&&c.marks.forEach(l=>{i===l.type&&n.addMark(d,d+c.nodeSize,i.create(vt(l.attrs,e)))})})}),!0):!1},gn=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),yn=()=>({tr:t,commands:e})=>e.setTextSelection({from:0,to:t.doc.content.size}),bn=()=>({state:t,dispatch:e})=>ue(t,e),kn=()=>({state:t,dispatch:e})=>le(t,e),Mn=()=>({state:t,dispatch:e})=>de(t,e),Sn=()=>({state:t,dispatch:e})=>pe(t,e),Tn=()=>({state:t,dispatch:e})=>fe(t,e);function jt(t,e,n={}){return X(t,e,{slice:!1,parseOptions:n})}const vn=(t,e=!1,n={})=>({tr:r,editor:s,dispatch:o})=>{const{doc:i}=r,a=jt(t,s.schema,n);return o&&r.replaceWith(0,i.content.size,a).setMeta("preventUpdate",!e),!0};function wn(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function xn(t,e){for(let n=t.depth;n>0;n-=1){const r=t.node(n);if(e(r))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:r}}}function yt(t){return e=>xn(e.$from,t)}function An(t,e){const n=qt.fromSchema(e).serializeFragment(t),s=document.implementation.createHTMLDocument().createElement("div");return s.appendChild(n),s.innerHTML}function En(t,e){const n={from:0,to:t.content.size};return Rt(t,n,e)}function U(t,e){const n=B(e,t.schema),{from:r,to:s,empty:o}=t.selection,i=[];o?(t.storedMarks&&i.push(...t.storedMarks),i.push(...t.selection.$head.marks())):t.doc.nodesBetween(r,s,u=>{i.push(...u.marks)});const a=i.find(u=>u.type.name===n.name);return a?{...a.attrs}:{}}function Cn(t,e){const n=w(e,t.schema),{from:r,to:s}=t.selection,o=[];t.doc.nodesBetween(r,s,a=>{o.push(a)});const i=o.reverse().find(a=>a.type.name===n.name);return i?{...i.attrs}:{}}function Ln(t,e){const n=nt(typeof e=="string"?e:e.name,t.schema);return n==="node"?Cn(t,e):n==="mark"?U(t,e):{}}function Dt(t,e,n){const r=[];return t===e?n.resolve(t).marks().forEach(s=>{const o=n.resolve(t-1),i=mt(o,s.type);i&&r.push({mark:s,...i})}):n.nodesBetween(t,e,(s,o)=>{r.push(...s.marks.map(i=>({from:o,to:o+s.nodeSize,mark:i})))}),r}function J(t,e,n){return Object.fromEntries(Object.entries(n).filter(([r])=>{const s=t.find(o=>o.type===e&&o.name===r);return s?s.attribute.keepOnSplit:!1}))}function dt(t,e,n={}){const{empty:r,ranges:s}=t.selection,o=e?B(e,t.schema):null;if(r)return!!(t.storedMarks||t.selection.$from.marks()).filter(l=>o?o.name===l.type.name:!0).find(l=>Q(l.attrs,n,{strict:!1}));let i=0;const a=[];if(s.forEach(({$from:l,$to:p})=>{const f=l.pos,h=p.pos;t.doc.nodesBetween(f,h,(g,y)=>{if(!g.isText&&!g.marks.length)return;const b=Math.max(f,y),k=Math.min(h,y+g.nodeSize),v=k-b;i+=v,a.push(...g.marks.map(C=>({mark:C,from:b,to:k})))})}),i===0)return!1;const u=a.filter(l=>o?o.name===l.mark.type.name:!0).filter(l=>Q(l.mark.attrs,n,{strict:!1})).reduce((l,p)=>l+p.to-p.from,0),c=a.filter(l=>o?l.mark.type!==o&&l.mark.type.excludes(o):!0).reduce((l,p)=>l+p.to-p.from,0);return(u>0?u+c:u)>=i}function $n(t,e,n={}){if(!e)return K(t,null,n)||dt(t,null,n);const r=nt(e,t.schema);return r==="node"?K(t,e,n):r==="mark"?dt(t,e,n):!1}function wt(t,e){const{nodeExtensions:n}=tt(e),r=n.find(i=>i.name===t);if(!r)return!1;const s={name:r.name,options:r.options,storage:r.storage},o=M(m(r,"group",s));return typeof o!="string"?!1:o.split(" ").includes("list")}function On(t){var e;const n=(e=t.type.createAndFill())===null||e===void 0?void 0:e.toJSON(),r=t.toJSON();return JSON.stringify(n)===JSON.stringify(r)}function Hn(t,e,n){var r;const{selection:s}=e;let o=null;if(It(s)&&(o=s.$cursor),o){const a=(r=t.storedMarks)!==null&&r!==void 0?r:o.marks();return!!n.isInSet(a)||!a.some(u=>u.type.excludes(n))}const{ranges:i}=s;return i.some(({$from:a,$to:u})=>{let c=a.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(n):!1;return t.doc.nodesBetween(a.pos,u.pos,(d,l,p)=>{if(c)return!1;if(d.isInline){const f=!p||p.type.allowsMarkType(n),h=!!n.isInSet(d.marks)||!d.marks.some(g=>g.type.excludes(n));c=f&&h}return!c}),c})}const Rn=(t,e={})=>({tr:n,state:r,dispatch:s})=>{const{selection:o}=n,{empty:i,ranges:a}=o,u=B(t,r.schema);if(s)if(i){const c=U(r,u);n.addStoredMark(u.create({...c,...e}))}else a.forEach(c=>{const d=c.$from.pos,l=c.$to.pos;r.doc.nodesBetween(d,l,(p,f)=>{const h=Math.max(f,d),g=Math.min(f+p.nodeSize,l);p.marks.find(b=>b.type===u)?p.marks.forEach(b=>{u===b.type&&n.addMark(h,g,u.create({...b.attrs,...e}))}):n.addMark(h,g,u.create(e))})});return Hn(r,n,u)},Pn=(t,e)=>({tr:n})=>(n.setMeta(t,e),!0),In=(t,e={})=>({state:n,dispatch:r,chain:s})=>{const o=w(t,n.schema);return o.isTextblock?s().command(({commands:i})=>bt(o,e)(n)?!0:i.clearNodes()).command(({state:i})=>bt(o,e)(i,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},Bn=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,s=N(t,0,r.content.size),o=$t.create(r,s);e.setSelection(o)}return!0},Nn=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,{from:s,to:o}=typeof t=="number"?{from:t,to:t}:t,i=O.atStart(r).from,a=O.atEnd(r).to,u=N(s,i,a),c=N(o,i,a),d=O.create(r,u,c);e.setSelection(d)}return!0},jn=t=>({state:e,dispatch:n})=>{const r=w(t,e.schema);return ge(r)(e,n)};function xt(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const r=n.filter(s=>e==null?void 0:e.includes(s.type.name));t.tr.ensureMarks(r)}}const Dn=({keepMarks:t=!0}={})=>({tr:e,state:n,dispatch:r,editor:s})=>{const{selection:o,doc:i}=e,{$from:a,$to:u}=o,c=s.extensionManager.attributes,d=J(c,a.node().type.name,a.node().attrs);if(o instanceof $t&&o.node.isBlock)return!a.parentOffset||!G(i,a.pos)?!1:(r&&(t&&xt(n,s.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;if(r){const l=u.parentOffset===u.parent.content.size;o instanceof O&&e.deleteSelection();const p=a.depth===0?void 0:wn(a.node(-1).contentMatchAt(a.indexAfter(-1)));let f=l&&p?[{type:p,attrs:d}]:void 0,h=G(e.doc,e.mapping.map(a.pos),1,f);if(!f&&!h&&G(e.doc,e.mapping.map(a.pos),1,p?[{type:p}]:void 0)&&(h=!0,f=p?[{type:p,attrs:d}]:void 0),h&&(e.split(e.mapping.map(a.pos),1,f),p&&!l&&!a.parentOffset&&a.parent.type!==p)){const g=e.mapping.map(a.before()),y=e.doc.resolve(g);a.node(-1).canReplaceWith(y.index(),y.index()+1,p)&&e.setNodeMarkup(e.mapping.map(a.before()),p)}t&&xt(n,s.extensionManager.splittableMarks),e.scrollIntoView()}return!0},Fn=t=>({tr:e,state:n,dispatch:r,editor:s})=>{var o;const i=w(t,n.schema),{$from:a,$to:u}=n.selection,c=n.selection.node;if(c&&c.isBlock||a.depth<2||!a.sameParent(u))return!1;const d=a.node(-1);if(d.type!==i)return!1;const l=s.extensionManager.attributes;if(a.parent.content.size===0&&a.node(-1).childCount===a.indexAfter(-1)){if(a.depth===2||a.node(-3).type!==i||a.index(-2)!==a.node(-2).childCount-1)return!1;if(r){let y=q.empty;const b=a.index(-1)?1:a.index(-2)?2:3;for(let P=a.depth-b;P>=a.depth-3;P-=1)y=q.from(a.node(P).copy(y));const k=a.indexAfter(-1)<a.node(-2).childCount?1:a.indexAfter(-2)<a.node(-3).childCount?2:3,v=J(l,a.node().type.name,a.node().attrs),C=((o=i.contentMatch.defaultType)===null||o===void 0?void 0:o.createAndFill(v))||void 0;y=y.append(q.from(i.createAndFill(null,C)||void 0));const x=a.before(a.depth-(b-1));e.replace(x,a.after(-k),new Vt(y,4-b,0));let $=-1;e.doc.nodesBetween(x,e.doc.content.size,(P,rt)=>{if($>-1)return!1;P.isTextblock&&P.content.size===0&&($=rt+1)}),$>-1&&e.setSelection(O.near(e.doc.resolve($))),e.scrollIntoView()}return!0}const p=u.pos===a.end()?d.contentMatchAt(0).defaultType:null,f=J(l,d.type.name,d.attrs),h=J(l,a.node().type.name,a.node().attrs);e.delete(a.pos,u.pos);const g=p?[{type:i,attrs:f},{type:p,attrs:h}]:[{type:i,attrs:f}];if(!G(e.doc,a.pos,2))return!1;if(r){const{selection:y,storedMarks:b}=n,{splittableMarks:k}=s.extensionManager,v=b||y.$to.parentOffset&&y.$from.marks();if(e.split(a.pos,2,g).scrollIntoView(),!v||!r)return!0;const C=v.filter(x=>k.includes(x.type.name));e.ensureMarks(C)}return!0},at=(t,e)=>{const n=yt(i=>i.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(r===void 0)return!0;const s=t.doc.nodeAt(r);return n.node.type===(s==null?void 0:s.type)&&ft(t.doc,n.pos)&&t.join(n.pos),!0},ct=(t,e)=>{const n=yt(i=>i.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(n.start).after(n.depth);if(r===void 0)return!0;const s=t.doc.nodeAt(r);return n.node.type===(s==null?void 0:s.type)&&ft(t.doc,r)&&t.join(r),!0},_n=(t,e,n,r={})=>({editor:s,tr:o,state:i,dispatch:a,chain:u,commands:c,can:d})=>{const{extensions:l,splittableMarks:p}=s.extensionManager,f=w(t,i.schema),h=w(e,i.schema),{selection:g,storedMarks:y}=i,{$from:b,$to:k}=g,v=b.blockRange(k),C=y||g.$to.parentOffset&&g.$from.marks();if(!v)return!1;const x=yt($=>wt($.type.name,l))(g);if(v.depth>=1&&x&&v.depth-x.depth<=1){if(x.node.type===f)return c.liftListItem(h);if(wt(x.node.type.name,l)&&f.validContent(x.node.content)&&a)return u().command(()=>(o.setNodeMarkup(x.pos,f),!0)).command(()=>at(o,f)).command(()=>ct(o,f)).run()}return!n||!C||!a?u().command(()=>d().wrapInList(f,r)?!0:c.clearNodes()).wrapInList(f,r).command(()=>at(o,f)).command(()=>ct(o,f)).run():u().command(()=>{const $=d().wrapInList(f,r),P=C.filter(rt=>p.includes(rt.type.name));return o.ensureMarks(P),$?!0:c.clearNodes()}).wrapInList(f,r).command(()=>at(o,f)).command(()=>ct(o,f)).run()},zn=(t,e={},n={})=>({state:r,commands:s})=>{const{extendEmptyMarkRange:o=!1}=n,i=B(t,r.schema);return dt(r,i,e)?s.unsetMark(i,{extendEmptyMarkRange:o}):s.setMark(i,e)},Kn=(t,e,n={})=>({state:r,commands:s})=>{const o=w(t,r.schema),i=w(e,r.schema);return K(r,o,n)?s.setNode(i):s.setNode(o,n)},Wn=(t,e={})=>({state:n,commands:r})=>{const s=w(t,n.schema);return K(n,s,e)?r.lift(s):r.wrapIn(s,e)},Vn=()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let r=0;r<n.length;r+=1){const s=n[r];let o;if(s.spec.isInputRules&&(o=s.getState(t))){if(e){const i=t.tr,a=o.transform;for(let u=a.steps.length-1;u>=0;u-=1)i.step(a.steps[u].invert(a.docs[u]));if(o.text){const u=i.doc.resolve(o.from).marks();i.replaceWith(o.from,o.to,t.schema.text(o.text,u))}else i.delete(o.from,o.to)}return!0}}return!1},Un=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:r,ranges:s}=n;return r||e&&s.forEach(o=>{t.removeMark(o.$from.pos,o.$to.pos)}),!0},qn=(t,e={})=>({tr:n,state:r,dispatch:s})=>{var o;const{extendEmptyMarkRange:i=!1}=e,{selection:a}=n,u=B(t,r.schema),{$from:c,empty:d,ranges:l}=a;if(!s)return!0;if(d&&i){let{from:p,to:f}=a;const h=(o=c.marks().find(y=>y.type===u))===null||o===void 0?void 0:o.attrs,g=mt(c,u,h);g&&(p=g.from,f=g.to),n.removeMark(p,f,u)}else l.forEach(p=>{n.removeMark(p.$from.pos,p.$to.pos,u)});return n.removeStoredMark(u),!0},Gn=(t,e={})=>({tr:n,state:r,dispatch:s})=>{let o=null,i=null;const a=nt(typeof t=="string"?t:t.name,r.schema);return a?(a==="node"&&(o=w(t,r.schema)),a==="mark"&&(i=B(t,r.schema)),s&&n.selection.ranges.forEach(u=>{const c=u.$from.pos,d=u.$to.pos;r.doc.nodesBetween(c,d,(l,p)=>{o&&o===l.type&&n.setNodeMarkup(p,void 0,{...l.attrs,...e}),i&&l.marks.length&&l.marks.forEach(f=>{if(i===f.type){const h=Math.max(p,c),g=Math.min(p+l.nodeSize,d);n.addMark(h,g,i.create({...f.attrs,...e}))}})})}),!0):!1},Jn=(t,e={})=>({state:n,dispatch:r})=>{const s=w(t,n.schema);return he(s,e)(n,r)},Qn=(t,e={})=>({state:n,dispatch:r})=>{const s=w(t,n.schema);return ye(s,e)(n,r)};var Xn=Object.freeze({__proto__:null,blur:je,clearContent:De,clearNodes:Fe,command:_e,createParagraphNear:ze,deleteCurrentNode:Ke,deleteNode:We,deleteRange:Ve,deleteSelection:Ue,enter:qe,exitCode:Ge,extendMarkRange:Qe,first:Xe,focus:Ye,forEach:Ze,insertContent:tn,insertContentAt:rn,joinUp:sn,joinDown:on,joinBackward:an,joinForward:cn,keyboardShortcut:ln,lift:dn,liftEmptyBlock:pn,liftListItem:fn,newlineInCode:hn,resetAttributes:mn,scrollIntoView:gn,selectAll:yn,selectNodeBackward:bn,selectNodeForward:kn,selectParentNode:Mn,selectTextblockEnd:Sn,selectTextblockStart:Tn,setContent:vn,setMark:Rn,setMeta:Pn,setNode:In,setNodeSelection:Bn,setTextSelection:Nn,sinkListItem:jn,splitBlock:Dn,splitListItem:Fn,toggleList:_n,toggleMark:zn,toggleNode:Kn,toggleWrap:Wn,undoInputRule:Vn,unsetAllMarks:Un,unsetMark:qn,updateAttributes:Gn,wrapIn:Jn,wrapInList:Qn});const Yn=E.create({name:"commands",addCommands(){return{...Xn}}}),Zn=E.create({name:"editable",addProseMirrorPlugins(){return[new I({key:new z("editable"),props:{editable:()=>this.editor.options.editable}})]}}),tr=E.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new I({key:new z("focusEvents"),props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const r=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,n)=>{t.isFocused=!1;const r=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),er=E.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:i})=>[()=>i.undoInputRule(),()=>i.command(({tr:a})=>{const{selection:u,doc:c}=a,{empty:d,$anchor:l}=u,{pos:p,parent:f}=l,h=_.atStart(c).from===p;return!d||!h||!f.type.isTextblock||f.textContent.length?!1:i.clearNodes()}),()=>i.deleteSelection(),()=>i.joinBackward(),()=>i.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:i})=>[()=>i.deleteSelection(),()=>i.deleteCurrentNode(),()=>i.joinForward(),()=>i.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:i})=>[()=>i.newlineInCode(),()=>i.createParagraphNear(),()=>i.liftEmptyBlock(),()=>i.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},s={...r},o={...r,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return gt()||Nt()?o:s},addProseMirrorPlugins(){return[new I({key:new z("clearDocument"),appendTransaction:(t,e,n)=>{if(!(t.some(h=>h.docChanged)&&!e.doc.eq(n.doc)))return;const{empty:s,from:o,to:i}=e.selection,a=_.atStart(e.doc).from,u=_.atEnd(e.doc).to;if(s||!(o===a&&i===u)||!(n.doc.textBetween(0,n.doc.content.size," "," ").length===0))return;const l=n.tr,p=Y({state:n,transaction:l}),{commands:f}=new Z({editor:this.editor,state:p});if(f.clearNodes(),!!l.steps.length)return l}})]}}),nr=E.create({name:"tabindex",addProseMirrorPlugins(){return[new I({key:new z("tabindex"),props:{attributes:this.editor.isEditable?{tabindex:"0"}:{}}})]}});var rr=Object.freeze({__proto__:null,ClipboardTextSerializer:Ne,Commands:Yn,Editable:Zn,FocusEvents:tr,Keymap:er,Tabindex:nr});const sr=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 1px !important;
  height: 1px !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function or(t,e){const n=document.querySelector("style[data-tiptap-style]");if(n!==null)return n;const r=document.createElement("style");return e&&r.setAttribute("nonce",e),r.setAttribute("data-tiptap-style",""),r.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(r),r}let ir=class extends ve{constructor(e={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=or(sr,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,n=!0){this.setOptions({editable:e}),n&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,n){const r=Ht(n)?n(e,[...this.state.plugins]):[...this.state.plugins,e],s=this.state.reconfigure({plugins:r});this.view.updateState(s)}unregisterPlugin(e){if(this.isDestroyed)return;const n=typeof e=="string"?`${e}$`:e.key,r=this.state.reconfigure({plugins:this.state.plugins.filter(s=>!s.key.startsWith(n))});this.view.updateState(r)}createExtensionManager(){const n=[...this.options.enableCoreExtensions?Object.values(rr):[],...this.options.extensions].filter(r=>["extension","node","mark"].includes(r==null?void 0:r.type));this.extensionManager=new F(n,this)}createCommandManager(){this.commandManager=new Z({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){const e=jt(this.options.content,this.schema,this.options.parseOptions),n=Bt(e,this.options.autofocus);this.view=new Kt(this.options.element,{...this.options.editorProps,dispatchTransaction:this.dispatchTransaction.bind(this),state:zt.create({doc:e,selection:n||void 0})});const r=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(r),this.createNodeViews();const s=this.view.dom;s.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const n=this.capturedTransaction;return this.capturedTransaction=null,n}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(i=>{var a;return(a=this.capturedTransaction)===null||a===void 0?void 0:a.step(i)});return}const n=this.state.apply(e),r=!this.state.selection.eq(n.selection);this.view.updateState(n),this.emit("transaction",{editor:this,transaction:e}),r&&this.emit("selectionUpdate",{editor:this,transaction:e});const s=e.getMeta("focus"),o=e.getMeta("blur");s&&this.emit("focus",{editor:this,event:s.event,transaction:e}),o&&this.emit("blur",{editor:this,event:o.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return Ln(this.state,e)}isActive(e,n){const r=typeof e=="string"?e:null,s=typeof e=="string"?n:e;return $n(this.state,r,s)}getJSON(){return this.state.doc.toJSON()}getHTML(){return An(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:n=`

`,textSerializers:r={}}=e||{};return En(this.state.doc,{blockSeparator:n,textSerializers:{...Pt(this.schema),...r}})}get isEmpty(){return On(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var e;return!(!((e=this.view)===null||e===void 0)&&e.docView)}};function j(t){return new V({find:t.find,handler:({state:e,range:n,match:r})=>{const s=M(t.getAttributes,void 0,r);if(s===!1||s===null)return null;const{tr:o}=e,i=r[r.length-1],a=r[0];let u=n.to;if(i){const c=a.search(/\S/),d=n.from+a.indexOf(i),l=d+i.length;if(Dt(n.from,n.to,e.doc).filter(f=>f.mark.type.excluded.find(g=>g===t.type&&g!==f.mark.type)).filter(f=>f.to>d).length)return null;l<n.to&&o.delete(l,n.to),d>n.from&&o.delete(n.from+c,d),u=n.from+c+i.length,o.addMark(n.from+c,u,t.type.create(s||{})),o.removeStoredMark(t.type)}}})}function ar(t){return new V({find:t.find,handler:({state:e,range:n,match:r})=>{const s=M(t.getAttributes,void 0,r)||{},{tr:o}=e,i=n.from;let a=n.to;if(r[1]){const u=r[0].lastIndexOf(r[1]);let c=i+u;c>a?c=a:a=c+r[1].length;const d=r[0][r[0].length-1];o.insertText(d,i+r[0].length-1),o.replaceWith(c,a,t.type.create(s))}else r[0]&&o.replaceWith(i,a,t.type.create(s))}})}function pt(t){return new V({find:t.find,handler:({state:e,range:n,match:r})=>{const s=e.doc.resolve(n.from),o=M(t.getAttributes,void 0,r)||{};if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),t.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,o)}})}function S(t){return new V({find:t.find,handler:({state:e,range:n,match:r})=>{let s=t.replace,o=n.from;const i=n.to;if(r[1]){const a=r[0].lastIndexOf(r[1]);s+=r[0].slice(a+r[1].length),o+=a;const u=o-i;u>0&&(s=r[0].slice(a-u,a)+s,o=i)}e.tr.insertText(s,o,i)}})}function W(t){return new V({find:t.find,handler:({state:e,range:n,match:r,chain:s})=>{const o=M(t.getAttributes,void 0,r)||{},i=e.tr.delete(n.from,n.to),u=i.doc.resolve(n.from).blockRange(),c=u&&Jt(u,t.type,o);if(!c)return null;if(i.wrap(u,c),t.keepMarks&&t.editor){const{selection:l,storedMarks:p}=e,{splittableMarks:f}=t.editor.extensionManager,h=p||l.$to.parentOffset&&l.$from.marks();if(h){const g=h.filter(y=>f.includes(y.type.name));i.ensureMarks(g)}}if(t.keepAttributes){const l=t.type.name==="bulletList"||t.type.name==="orderedList"?"listItem":"taskList";s().updateAttributes(l,o).run()}const d=i.doc.resolve(n.from-1).nodeBefore;d&&d.type===t.type&&ft(i.doc,n.from-1)&&(!t.joinPredicate||t.joinPredicate(r,d))&&i.join(n.from-1)}})}class H{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=M(m(this,"addOptions",{name:this.name}))),this.storage=M(m(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new H(e)}configure(e={}){const n=this.extend();return n.options=et(this.options,e),n.storage=M(m(n,"addStorage",{name:n.name,options:n.options})),n}extend(e={}){const n=new H(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=M(m(n,"addOptions",{name:n.name})),n.storage=M(m(n,"addStorage",{name:n.name,options:n.options})),n}static handleExit({editor:e,mark:n}){const{tr:r}=e.state,s=e.state.selection.$from;if(s.pos===s.end()){const i=s.marks();if(!!!i.find(c=>(c==null?void 0:c.type.name)===n.name))return!1;const u=i.find(c=>(c==null?void 0:c.type.name)===n.name);return u&&r.removeStoredMark(u),r.insertText(" ",s.pos),e.view.dispatch(r),!0}return!1}}class A{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=M(m(this,"addOptions",{name:this.name}))),this.storage=M(m(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new A(e)}configure(e={}){const n=this.extend();return n.options=et(this.options,e),n.storage=M(m(n,"addStorage",{name:n.name,options:n.options})),n}extend(e={}){const n=new A(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=M(m(n,"addOptions",{name:n.name})),n.storage=M(m(n,"addStorage",{name:n.name,options:n.options})),n}}function D(t){return new Oe({find:t.find,handler:({state:e,range:n,match:r})=>{const s=M(t.getAttributes,void 0,r);if(s===!1||s===null)return null;const{tr:o}=e,i=r[r.length-1],a=r[0];let u=n.to;if(i){const c=a.search(/\S/),d=n.from+a.indexOf(i),l=d+i.length;if(Dt(n.from,n.to,e.doc).filter(f=>f.mark.type.excluded.find(g=>g===t.type&&g!==f.mark.type)).filter(f=>f.to>d).length)return null;l<n.to&&o.delete(l,n.to),d>n.from&&o.delete(n.from+c,d),u=n.from+c+i.length,o.addMark(n.from+c,u,t.type.create(s||{})),o.removeStoredMark(t.type)}}})}const Hs=H.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:t=>t.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["span",T(this.options.HTMLAttributes,t),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:t,commands:e})=>{const n=U(t,this.type);return Object.entries(n).some(([,s])=>!!s)?!0:e.unsetMark(this.name)}}}}),Rs=E.create({name:"color",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{color:{default:null,parseHTML:t=>{var e;return(e=t.style.color)===null||e===void 0?void 0:e.replace(/['"]+/g,"")},renderHTML:t=>t.color?{style:`color: ${t.color}`}:{}}}}]},addCommands(){return{setColor:t=>({chain:e})=>e().setMark("textStyle",{color:t}).run(),unsetColor:()=>({chain:t})=>t().setMark("textStyle",{color:null}).removeEmptyTextStyle().run()}}}),cr=/(?:^|\s)((?:==)((?:[^~=]+))(?:==))$/,ur=/(?:^|\s)((?:==)((?:[^~=]+))(?:==))/g,Ps=H.create({name:"highlight",addOptions(){return{multicolor:!1,HTMLAttributes:{}}},addAttributes(){return this.options.multicolor?{color:{default:null,parseHTML:t=>t.getAttribute("data-color")||t.style.backgroundColor,renderHTML:t=>t.color?{"data-color":t.color,style:`background-color: ${t.color}; color: inherit`}:{}}}:{}},parseHTML(){return[{tag:"mark"}]},renderHTML({HTMLAttributes:t}){return["mark",T(this.options.HTMLAttributes,t),0]},addCommands(){return{setHighlight:t=>({commands:e})=>e.setMark(this.name,t),toggleHighlight:t=>({commands:e})=>e.toggleMark(this.name,t),unsetHighlight:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-h":()=>this.editor.commands.toggleHighlight()}},addInputRules(){return[j({find:cr,type:this.type})]},addPasteRules(){return[D({find:ur,type:this.type})]}}),lr=A.create({name:"listItem",addOptions(){return{HTMLAttributes:{}}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",T(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),dr=S({find:/--$/,replace:"—"}),pr=S({find:/\.\.\.$/,replace:"…"}),fr=S({find:/(?:^|[\s{[(<'"\u2018\u201C])(")$/,replace:"“"}),hr=S({find:/"$/,replace:"”"}),mr=S({find:/(?:^|[\s{[(<'"\u2018\u201C])(')$/,replace:"‘"}),gr=S({find:/'$/,replace:"’"}),yr=S({find:/<-$/,replace:"←"}),br=S({find:/->$/,replace:"→"}),kr=S({find:/\(c\)$/,replace:"©"}),Mr=S({find:/\(tm\)$/,replace:"™"}),Sr=S({find:/\(sm\)$/,replace:"℠"}),Tr=S({find:/\(r\)$/,replace:"®"}),vr=S({find:/(?:^|\s)(1\/2)$/,replace:"½"}),wr=S({find:/\+\/-$/,replace:"±"}),xr=S({find:/!=$/,replace:"≠"}),Ar=S({find:/<<$/,replace:"«"}),Er=S({find:/>>$/,replace:"»"}),Cr=S({find:/\d+\s?([*x])\s?\d+$/,replace:"×"}),Lr=S({find:/\^2$/,replace:"²"}),$r=S({find:/\^3$/,replace:"³"}),Or=S({find:/(?:^|\s)(1\/4)$/,replace:"¼"}),Hr=S({find:/(?:^|\s)(3\/4)$/,replace:"¾"}),Is=E.create({name:"typography",addInputRules(){const t=[];return this.options.emDash!==!1&&t.push(dr),this.options.ellipsis!==!1&&t.push(pr),this.options.openDoubleQuote!==!1&&t.push(fr),this.options.closeDoubleQuote!==!1&&t.push(hr),this.options.openSingleQuote!==!1&&t.push(mr),this.options.closeSingleQuote!==!1&&t.push(gr),this.options.leftArrow!==!1&&t.push(yr),this.options.rightArrow!==!1&&t.push(br),this.options.copyright!==!1&&t.push(kr),this.options.trademark!==!1&&t.push(Mr),this.options.servicemark!==!1&&t.push(Sr),this.options.registeredTrademark!==!1&&t.push(Tr),this.options.oneHalf!==!1&&t.push(vr),this.options.plusMinus!==!1&&t.push(wr),this.options.notEqual!==!1&&t.push(xr),this.options.laquo!==!1&&t.push(Ar),this.options.raquo!==!1&&t.push(Er),this.options.multiplication!==!1&&t.push(Cr),this.options.superscriptTwo!==!1&&t.push(Lr),this.options.superscriptThree!==!1&&t.push($r),this.options.oneQuarter!==!1&&t.push(Or),this.options.threeQuarters!==!1&&t.push(Hr),t}});class Rr extends ir{constructor(){super(...arguments),this.contentComponent=null}}const Pr=({renderers:t})=>R.createElement(R.Fragment,null,Object.entries(t).map(([e,n])=>_t.createPortal(n.reactElement,n.element,e)));class Ir extends R.Component{constructor(e){super(e),this.editorContentRef=R.createRef(),this.initialized=!1,this.state={renderers:{}}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const{editor:e}=this.props;if(e&&e.options.element){if(e.contentComponent)return;const n=this.editorContentRef.current;n.append(...e.options.element.childNodes),e.setOptions({element:n}),e.contentComponent=this,e.createNodeViews(),this.initialized=!0}}maybeFlushSync(e){this.initialized?Ft.flushSync(e):e()}setRenderer(e,n){this.maybeFlushSync(()=>{this.setState(({renderers:r})=>({renderers:{...r,[e]:n}}))})}removeRenderer(e){this.maybeFlushSync(()=>{this.setState(({renderers:n})=>{const r={...n};return delete r[e],{renderers:r}})})}componentWillUnmount(){const{editor:e}=this.props;if(!e||(this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),e.contentComponent=null,!e.options.element.firstChild))return;const n=document.createElement("div");n.append(...e.options.element.childNodes),e.setOptions({element:n})}render(){const{editor:e,...n}=this.props;return R.createElement(R.Fragment,null,R.createElement("div",{ref:this.editorContentRef,...n}),R.createElement(Pr,{renderers:this.state.renderers}))}}const Bs=R.memo(Ir),Br=L.createContext({onDragStart:void 0}),Nr=()=>L.useContext(Br);R.forwardRef((t,e)=>{const{onDragStart:n}=Nr(),r=t.as||"div";return R.createElement(r,{...t,ref:e,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...t.style}})});function jr(){const[,t]=L.useState(0);return()=>t(e=>e+1)}const Ns=(t={},e=[])=>{const[n,r]=L.useState(null),s=jr(),{onBeforeCreate:o,onBlur:i,onCreate:a,onDestroy:u,onFocus:c,onSelectionUpdate:d,onTransaction:l,onUpdate:p}=t,f=L.useRef(o),h=L.useRef(i),g=L.useRef(a),y=L.useRef(u),b=L.useRef(c),k=L.useRef(d),v=L.useRef(l),C=L.useRef(p);return L.useEffect(()=>{n&&(o&&(n.off("beforeCreate",f.current),n.on("beforeCreate",o),f.current=o),i&&(n.off("blur",h.current),n.on("blur",i),h.current=i),a&&(n.off("create",g.current),n.on("create",a),g.current=a),u&&(n.off("destroy",y.current),n.on("destroy",u),y.current=u),c&&(n.off("focus",b.current),n.on("focus",c),b.current=c),d&&(n.off("selectionUpdate",k.current),n.on("selectionUpdate",d),k.current=d),l&&(n.off("transaction",v.current),n.on("transaction",l),v.current=l),p&&(n.off("update",C.current),n.on("update",p),C.current=p))},[o,i,a,u,c,d,l,p,n]),L.useEffect(()=>{let x=!0;const $=new Rr(t);return r($),$.on("transaction",()=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{x&&s()})})}),()=>{$.destroy(),x=!1}},e),n},Dr=/^\s*>\s$/,Fr=A.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return["blockquote",T(this.options.HTMLAttributes,t),0]},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[W({find:Dr,type:this.type})]}}),_r=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))$/,zr=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))/g,Kr=/(?:^|\s)((?:__)((?:[^__]+))(?:__))$/,Wr=/(?:^|\s)((?:__)((?:[^__]+))(?:__))/g,Vr=H.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return["strong",T(this.options.HTMLAttributes,t),0]},addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[j({find:_r,type:this.type}),j({find:Kr,type:this.type})]},addPasteRules(){return[D({find:zr,type:this.type}),D({find:Wr,type:this.type})]}}),Ur=A.create({name:"listItem",addOptions(){return{HTMLAttributes:{}}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",T(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),At=H.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:t=>t.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["span",T(this.options.HTMLAttributes,t),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:t,commands:e})=>{const n=U(t,this.type);return Object.entries(n).some(([,s])=>!!s)?!0:e.unsetMark(this.name)}}}}),Et=/^\s*([-+*])\s$/,qr=A.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",T(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(Ur.name,this.editor.getAttributes(At.name)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=W({find:Et,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=W({find:Et,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(At.name),editor:this.editor})),[t]}}),Gr=/(?:^|\s)((?:`)((?:[^`]+))(?:`))$/,Jr=/(?:^|\s)((?:`)((?:[^`]+))(?:`))/g,Qr=H.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",T(this.options.HTMLAttributes,t),0]},addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[j({find:Gr,type:this.type})]},addPasteRules(){return[D({find:Jr,type:this.type})]}}),Xr=/^```([a-z]+)?[\s\n]$/,Yr=/^~~~([a-z]+)?[\s\n]$/,Zr=A.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:t=>{var e;const{languageClassPrefix:n}=this.options,o=[...((e=t.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(i=>i.startsWith(n)).map(i=>i.replace(n,""))[0];return o||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:e}){return["pre",T(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,n=e.pos===1;return!t||e.parent.type.name!==this.name?!1:n||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:n}=e,{$from:r,empty:s}=n;if(!s||r.parent.type!==this.type)return!1;const o=r.parentOffset===r.parent.nodeSize-2,i=r.parent.textContent.endsWith(`

`);return!o||!i?!1:t.chain().command(({tr:a})=>(a.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:n,doc:r}=e,{$from:s,empty:o}=n;if(!o||s.parent.type!==this.type||!(s.parentOffset===s.parent.nodeSize-2))return!1;const a=s.after();return a===void 0||r.nodeAt(a)?!1:t.commands.exitCode()}}},addInputRules(){return[pt({find:Xr,type:this.type,getAttributes:t=>({language:t[1]})}),pt({find:Yr,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new I({key:new z("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const n=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),s=r?JSON.parse(r):void 0,o=s==null?void 0:s.mode;if(!n||!o)return!1;const{tr:i}=t.state;return i.replaceSelectionWith(this.type.create({language:o})),i.setSelection(O.near(i.doc.resolve(Math.max(0,i.selection.from-2)))),i.insertText(n.replace(/\r\n?/g,`
`)),i.setMeta("paste",!0),t.dispatch(i),!0}}})]}}),ts=A.create({name:"doc",topNode:!0,content:"block+"}),es=E.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[be(this.options)]}}),ns=E.create({name:"gapCursor",addProseMirrorPlugins(){return[ke()]},extendNodeSchema(t){var e;const n={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(e=M(m(t,"allowGapCursor",n)))!==null&&e!==void 0?e:null}}}),rs=A.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",T(this.options.HTMLAttributes,t)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:n,editor:r})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:s,storedMarks:o}=n;if(s.$from.parent.type.spec.isolating)return!1;const{keepMarks:i}=this.options,{splittableMarks:a}=r.extensionManager,u=o||s.$to.parentOffset&&s.$from.marks();return e().insertContent({type:this.name}).command(({tr:c,dispatch:d})=>{if(d&&u&&i){const l=u.filter(p=>a.includes(p.type.name));c.ensureMarks(l)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),ss=A.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,T(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.setNode(this.name,t):!1,toggleHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>pt({find:new RegExp(`^(#{1,${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}}),os=E.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>Me(t,e),redo:()=>({state:t,dispatch:e})=>Se(t,e)}},addProseMirrorPlugins(){return[Te(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Mod-y":()=>this.editor.commands.redo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-я":()=>this.editor.commands.undo(),"Shift-Mod-я":()=>this.editor.commands.redo()}}}),is=A.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",T(this.options.HTMLAttributes,t)]},addCommands(){return{setHorizontalRule:()=>({chain:t})=>t().insertContent({type:this.name}).command(({tr:e,dispatch:n})=>{var r;if(n){const{$to:s}=e.selection,o=s.end();if(s.nodeAfter)e.setSelection(O.create(e.doc,s.pos));else{const i=(r=s.parent.type.contentMatch.defaultType)===null||r===void 0?void 0:r.create();i&&(e.insert(o,i),e.setSelection(O.create(e.doc,o)))}e.scrollIntoView()}return!0}).run()}},addInputRules(){return[ar({find:/^(?:---|—-|___\s|\*\*\*\s)$/,type:this.type})]}}),as=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))$/,cs=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))/g,us=/(?:^|\s)((?:_)((?:[^_]+))(?:_))$/,ls=/(?:^|\s)((?:_)((?:[^_]+))(?:_))/g,ds=H.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",T(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[j({find:as,type:this.type}),j({find:us,type:this.type})]},addPasteRules(){return[D({find:cs,type:this.type}),D({find:ls,type:this.type})]}}),ps=A.create({name:"listItem",addOptions(){return{HTMLAttributes:{}}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",T(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Ct=H.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:t=>t.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["span",T(this.options.HTMLAttributes,t),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:t,commands:e})=>{const n=U(t,this.type);return Object.entries(n).some(([,s])=>!!s)?!0:e.unsetMark(this.name)}}}}),Lt=/^(\d+)\.\s$/,fs=A.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:e,...n}=t;return e===1?["ol",T(this.options.HTMLAttributes,n),0]:["ol",T(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(ps.name,this.editor.getAttributes(Ct.name)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=W({find:Lt,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=W({find:Lt,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(Ct.name)}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1],editor:this.editor})),[t]}}),hs=A.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",T(this.options.HTMLAttributes,t),0]},addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),ms=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))$/,gs=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))/g,ys=H.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",T(this.options.HTMLAttributes,t),0]},addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-x":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[j({find:ms,type:this.type})]},addPasteRules(){return[D({find:gs,type:this.type})]}}),bs=A.create({name:"text",group:"inline"}),js=E.create({name:"starterKit",addExtensions(){var t,e,n,r,s,o,i,a,u,c,d,l,p,f,h,g,y,b;const k=[];return this.options.blockquote!==!1&&k.push(Fr.configure((t=this.options)===null||t===void 0?void 0:t.blockquote)),this.options.bold!==!1&&k.push(Vr.configure((e=this.options)===null||e===void 0?void 0:e.bold)),this.options.bulletList!==!1&&k.push(qr.configure((n=this.options)===null||n===void 0?void 0:n.bulletList)),this.options.code!==!1&&k.push(Qr.configure((r=this.options)===null||r===void 0?void 0:r.code)),this.options.codeBlock!==!1&&k.push(Zr.configure((s=this.options)===null||s===void 0?void 0:s.codeBlock)),this.options.document!==!1&&k.push(ts.configure((o=this.options)===null||o===void 0?void 0:o.document)),this.options.dropcursor!==!1&&k.push(es.configure((i=this.options)===null||i===void 0?void 0:i.dropcursor)),this.options.gapcursor!==!1&&k.push(ns.configure((a=this.options)===null||a===void 0?void 0:a.gapcursor)),this.options.hardBreak!==!1&&k.push(rs.configure((u=this.options)===null||u===void 0?void 0:u.hardBreak)),this.options.heading!==!1&&k.push(ss.configure((c=this.options)===null||c===void 0?void 0:c.heading)),this.options.history!==!1&&k.push(os.configure((d=this.options)===null||d===void 0?void 0:d.history)),this.options.horizontalRule!==!1&&k.push(is.configure((l=this.options)===null||l===void 0?void 0:l.horizontalRule)),this.options.italic!==!1&&k.push(ds.configure((p=this.options)===null||p===void 0?void 0:p.italic)),this.options.listItem!==!1&&k.push(lr.configure((f=this.options)===null||f===void 0?void 0:f.listItem)),this.options.orderedList!==!1&&k.push(fs.configure((h=this.options)===null||h===void 0?void 0:h.orderedList)),this.options.paragraph!==!1&&k.push(hs.configure((g=this.options)===null||g===void 0?void 0:g.paragraph)),this.options.strike!==!1&&k.push(ys.configure((y=this.options)===null||y===void 0?void 0:y.strike)),this.options.text!==!1&&k.push(bs.configure((b=this.options)===null||b===void 0?void 0:b.text)),k}});export{Rs as C,E,Ps as H,lr as L,js as S,Is as T,Hs as a,Bs as b,S as t,Ns as u};
